#erlang 快速编译工具  qmake

1. 效率
    在i7 4代4核8线程 16G内存，使用8个子进程编译的情况下，编译4000个文件在170s左右；
    在i5 10代6核12线程 32G内存，使用8个子进程的情况下，编译4000个文件在120s左右；
    热更的情况下基本是：3到4s过滤时间+Xs， X取决于本次更新多少个文件，零点零几秒到全编译的时间之间，比如加行打印，只需要不到1s。
    以上只是粗略统计， 本人对电脑配置一知半解。![qmake](./image/1.jpg)
2. 配置
    在宏中将YourName，YourPath替换即可
3. 特色
   相比rebar3效率有巨大提升，不在需要等待半小时编译完整个项目，也不需要几分钟来等待一行DEBUG的热更；
   使用Emakefile，不需要改变编译配置；
   头文件改变可以快速找到需要编译的erl文件；
   tips：第一次建议还是使用rebar编译，以便拉取外部依赖
4. 优化
*   可以根据自己的配置调整每个子进程编译数量，以及启用子进程数。（我自己的机器在子进程编译数量在20-25之间用时最少）
*   可以根据项目需要，在编译完后添加一些自定义的功能，比如JPS寻路地图标记文件的生成/更新。
*  如要实现编译完即时更新运行代码，可接入自己项目的热更方式，或者不介意内存占用可以使用reloader(使用方式自行搜索)这个模块。   
*  编译顺序， 本模块目前只提前编译了自定义的行为模块， 如有需求，可自行添加。（不介意打印提示，也可以忽略这一步）
5. 使用
* 在完成宏的定义后，示例编译脚本
```
erl -noshell -pa ebin -eval "case make:files([\"src/tools/qmake.erl\"], [{outdir, \"ebin/\"}]) of error -> halt(1); _ -> ok end" -eval "case qmake:compile(8) of success -> halt(0); error -> halt(1) end."
```
6. 趣事                                               
  刚刚开始使用erlang的时候，对于不能方便的使用断点调试这一点简直觉得反人类，在写一些递归处理的时候，每一次调试都需要显式的写打印语句，这样做，热更就成了一个紧迫的需求，对于以前习惯使用Java等其它语言的同学来说单击一下就能解决，编辑器都提供了很好的支持。当时刚毕业，才接触erlang，对于原有的热更模块，我加一个打印需要等四五分钟甚至更久，以至于我觉得我上班的大部分时间都在等待，跟导师吐槽这个事，在他的建议下尝试编写了这个模块，期间也听取了许多大佬的建议（比如用md5代替文件最后修改时间作文版本依据， 如果调了本地时间就会造成编译的错乱，上文提到的reloader也存在这个问题），最后这个模块成功替代了原来的编译模块，提升了工作效率。
    上面的优化建议都是根据实际的需求加以改进，这部分我就不放出来了。感谢阅读！
![qmake](./image/2.jpg)

7. 使用十代I5的情况下， 5000的文件能提速到120s左右
